'''
Created on Oct 30, 2017

@author: matti
'''

import bclab
import logging
import time


class TestProducer(bclab.Producer):
    def __init__(self, logger, broker_address, broker_port, client_id):
        super(TestProducer, self).__init__(logger, broker_address, broker_port, client_id)
        self.total_rows_sent = 0
        self.is_running = True
    
    
    def on_arm(self, attr):
        ch0 = bclab.DataChannel("c0", 0, -1, 1, "emg")
        ch1 = bclab.DataChannel("c0", 1, -1, 1, "emg")
        self.initialize_data(1000, 2, [ch0, ch1])

    def produce(self):
        status = self.get_status()

        if status in [bclab.STATUS_ARMED, bclab.STATUS_TRIGGERED]:
            s = "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"
            self.stream_data(s, self.total_rows_sent, 1000)
            self.total_rows_sent += 1000
            print("o", end=' ')
        else:
            print(".", end=' ')

if __name__ == '__main__':
    logging.getLogger().setLevel(logging.INFO)
    logging.info('running')
    producer= TestProducer(logging, 'localhost', 1883, "test_producer" )
    loop_iter = 0
    while True:
        producer.produce()
        if producer.get_status() in [bclab.STATUS_ARMED, bclab.STATUS_TRIGGERED] and not loop_iter % 10:
            producer.post_analysis('test_producer/analysis', count=loop_iter)
        time.sleep(0.5)
        loop_iter += 1
